###repeat model practice
#download aurelia aurita genome from NCBI with URL (into genomes directory)
wget https://api.ncbi.nlm.nih.gov/datasets/v2/genome/accession/GCA_004194415.1/download?include_annotation_type=GENOME_FASTA&include_annotation_type=GENOME_GFF&include_annotation_type=RNA_FASTA&include_annotation_type=CDS_FASTA&include_annotation_type=PROT_FASTA&include_annotation_type=SEQUENCE_REPORT&hydrated=FULLY_HYDRATED
#name the file (aurelia_aurita_genome.fna)

#determine what file type it is. If fasta then its fine. If it is zipped, you need to unzip it
unzip aurelia_aurita_genome
#create a job (type the code below to open a job script, its a different workspace than the main terminal. Then type in sbatch and all the code you want to run)
nano aurelia_aurita_job #creates a job

#!/bin/bash
#SBATCH -p 128x24   # Partition name
#SBATCH -J repeatmodeler_aurelia        # Job name
#SBATCH --mail-user=aymays@ucsc.edu
#SBATCH --mail-type=ALL
#SBATCH -o repeatmodeler_aurelia.out    # Name of stdout output file
#SBATCH -N 1       # Total number of nodes requested (128x24/Instructional only)
#SBATCH -n 16        # Total number of mpi tasks requested per node
#SBATCH -t 64:00:00  # Run Time (hh:mm:ss) - 1.5 hours (optional)
#SBATCH --mem=12G # Memory to be allocated PER NODE

export LC_ALL='C'

#load repeat modeler
module load repeatmodeler
#make a genome database with your genome so repeat modeler can use your genome file (my genome file is aurelia_aurita_genome and I'm naming the database auralia_aurita_db)
BuildDatabase -name aurelia_aurita_db aurelia_aurita_genome
#run repeat modeler
RepeatModeler -engine ncbi -threads 16 -database aurelia_aurita_db


#now save the job script with Ctrl+O (the letter O) and press enter to save its name
#once its saved, press Ctrl+X to exit the editor
#run the code using sbatch and the name of the job script
sbatch aurelia_aurita_repeatmodeler

#output will be families.fa, families.stk, and rmod.log files. Information on where these files are stored can be found in the output file specified in the job script (repeatmodeler_aurelia.out)


